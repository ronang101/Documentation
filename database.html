<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Database package &#8212; Redwood Prototype v1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d1102ebc" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=12dfc556" />
    <script src="_static/documentation_options.js?v=5cb08e4e"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="canonical" href="https://ronang101.github.io/Documentation/database.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Utils package" href="utils.html" />
    <link rel="prev" title="Algorithms package" href="algorithms.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="database-package">
<span id="database-label"></span><h1>Database package<a class="headerlink" href="#database-package" title="Link to this heading">¶</a></h1>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Link to this heading">¶</a></h2>
<p>This section contains detailed documentation of the database package, encompassing a variety of modules designed for interacting with the database through, select, insert and delete statements.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#apply-filters-label"><span class="std std-ref">apply_filters.py</span></a></p></li>
<li><p><a class="reference internal" href="#db-connection-web-label"><span class="std std-ref">db_connection_web.py</span></a></p></li>
<li><p><a class="reference internal" href="#user-creation-label"><span class="std std-ref">user_creation.py</span></a></p></li>
</ul>
</section>
<section id="module-database.apply_filters">
<span id="database-apply-filters-module"></span><span id="apply-filters-label"></span><h2>database.apply_filters module<a class="headerlink" href="#module-database.apply_filters" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="database.apply_filters.apply_filters">
<span class="sig-prename descclassname"><span class="pre">database.apply_filters.</span></span><span class="sig-name descname"><span class="pre">apply_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_uni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_prof</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.apply_filters.apply_filters" title="Link to this definition">¶</a></dt>
<dd><p>Applies the given filters to fetch users from the database, excluding users
already interacted with by the current user.</p>
<p>Args:</p>
<ul class="simple">
<li><p>cur: Database cursor for executing SQL queries.</p></li>
<li><p>filters (dict): A dictionary containing filter criteria.</p></li>
<li><p>user_id (int): The ID of the current user to exclude their interactions.</p></li>
<li><p>filter_uni (bool): Indicates if university filter should be applied.</p></li>
<li><p>filter_prof (bool): Indicates if profession filter should be applied.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>tuple: A tuple containing two lists - all_users (all filtered users
which will be used for collab filtering) and non_interacted_users
(users not yet interacted with).</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.apply_filters.create_filter_query">
<span class="sig-prename descclassname"><span class="pre">database.apply_filters.</span></span><span class="sig-name descname"><span class="pre">create_filter_query</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_uni</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_prof</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.apply_filters.create_filter_query" title="Link to this definition">¶</a></dt>
<dd><p>Constructs an SQL query to filter users based on specified criteria and
excludes users who have already interacted with the current user.</p>
<p>Args:</p>
<ul class="simple">
<li><p>filters (dict): A dictionary containing the user’s filter preferences.</p></li>
<li><p>user_id (int): The ID of the current user, used to exclude their
previous interactions.</p></li>
<li><p>filter_uni (bool): Flag to determine if university filter should be
applied.</p></li>
<li><p>filter_prof (bool): Flag to determine if profession filter should be
applied.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>str: An SQL query string for fetching filtered user data.</p></li>
</ul>
</dd></dl>

</section>
<section id="module-database.db_connection_web">
<span id="database-db-connection-web-module"></span><span id="db-connection-web-label"></span><h2>database.db_connection_web module<a class="headerlink" href="#module-database.db_connection_web" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="database.db_connection_web.account_deletion">
<span class="sig-prename descclassname"><span class="pre">database.db_connection_web.</span></span><span class="sig-name descname"><span class="pre">account_deletion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cur</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.db_connection_web.account_deletion" title="Link to this definition">¶</a></dt>
<dd><p>Deletes a user’s account and all associated data from the database.</p>
<p>Args:</p>
<ul class="simple">
<li><p>user_id (int): The ID of the user whose account is to be deleted.</p></li>
<li><p>conn: Database connection object.</p></li>
<li><p>cur: Database cursor for executing queries.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>bool: True if the deletion was successful, False otherwise.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.db_connection_web.check_user_exists">
<span class="sig-prename descclassname"><span class="pre">database.db_connection_web.</span></span><span class="sig-name descname"><span class="pre">check_user_exists</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">firebase_uid</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.db_connection_web.check_user_exists" title="Link to this definition">¶</a></dt>
<dd><p>Checks if a user exists in the database based on Firebase UID.</p>
<p>Args:</p>
<ul class="simple">
<li><p>cur: Database cursor for executing queries.</p></li>
<li><p>firebase_uid (str): Firebase UID of the user.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>int/None: The user ID if the user exists, None otherwise.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.db_connection_web.get_matches">
<span class="sig-prename descclassname"><span class="pre">database.db_connection_web.</span></span><span class="sig-name descname"><span class="pre">get_matches</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.db_connection_web.get_matches" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves matches for a specific user from the database.</p>
<p>Args:</p>
<ul class="simple">
<li><p>cur: Database cursor for executing queries.</p></li>
<li><p>user_id (int): The ID of the user for whom matches are being fetched.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>list: A list of dictionaries, each containing detailed information about
a match. All infromation included is required to populate a match card on
the front end.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.db_connection_web.get_user_data">
<span class="sig-prename descclassname"><span class="pre">database.db_connection_web.</span></span><span class="sig-name descname"><span class="pre">get_user_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.db_connection_web.get_user_data" title="Link to this definition">¶</a></dt>
<dd><p>Fetches and formats a specific user’s data from the database, this is used
for the edit page in order to pre populate the form fields.</p>
<p>Args:</p>
<ul class="simple">
<li><p>cur: Database cursor for executing queries.</p></li>
<li><p>user_id (int): The ID of the user whose data is to be fetched.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>dict: A dictionary containing detailed information of the user.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.db_connection_web.get_user_isochrone_data">
<span class="sig-prename descclassname"><span class="pre">database.db_connection_web.</span></span><span class="sig-name descname"><span class="pre">get_user_isochrone_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.db_connection_web.get_user_isochrone_data" title="Link to this definition">¶</a></dt>
<dd><p>Retrieves the isochrone data along with latitude and longitude for a given
user from the database.</p>
<p>This function executes a SQL query to fetch the isochrone data, which
represents the geographic area accessible within a certain time frame
from the user’s location. It also retrieves the user’s latitude and
longitude coordinates.</p>
<p>Args:</p>
<ul class="simple">
<li><p>cur: The database cursor used to execute the query.</p></li>
<li><p>user_id (int): The ID of the user for whom to retrieve the isochrone
data.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>tuple: A tuple containing the isochrone data as a JSON object (or other
format depending on the database), and the latitude and longitude
coordinates of the user as floats.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.db_connection_web.update_user_dicts">
<span class="sig-prename descclassname"><span class="pre">database.db_connection_web.</span></span><span class="sig-name descname"><span class="pre">update_user_dicts</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cur</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">user_id</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_type</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.db_connection_web.update_user_dicts" title="Link to this definition">¶</a></dt>
<dd><p>Updates a single user’s features or preferences in the database.</p>
<p>Args:
- cur: Database cursor object for executing queries.
- user_id: ID of the user to update.
- data: Dictionary containing features or preferences.
- data_type: Type of data to update (‘features’ or ‘preferences’).</p>
<p>Returns:
- None</p>
</dd></dl>

</section>
<section id="module-database.user_creation">
<span id="database-user-creation-module"></span><span id="user-creation-label"></span><h2>database.user_creation module<a class="headerlink" href="#module-database.user_creation" title="Link to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="database.user_creation.add_user">
<span class="sig-prename descclassname"><span class="pre">database.user_creation.</span></span><span class="sig-name descname"><span class="pre">add_user</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">firebase_uid</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.user_creation.add_user" title="Link to this definition">¶</a></dt>
<dd><p>Adds a new user to the database from a web form submission.</p>
<p>Args:</p>
<ul class="simple">
<li><p>firebase_uid (str): A string representing the users firebase_uid, this
will be provided upon signing in.</p></li>
<li><p>conn: Database connection object.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>int: An integer representing the users ID in order to add to the session.</p></li>
</ul>
<p>This function extracts user information from a submitted web form,
including personal details, preferences, and filters. It then creates
a new user record in the database and returns the new user’s id
in order to add them to the session. This function also handles
the standard formatting of profile pictures (300x300px) and fetching
a users isochrone.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.user_creation.parse_filter_range">
<span class="sig-prename descclassname"><span class="pre">database.user_creation.</span></span><span class="sig-name descname"><span class="pre">parse_filter_range</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filter_range</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_value</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.user_creation.parse_filter_range" title="Link to this definition">¶</a></dt>
<dd><p>Parses a filter range string and calculates the minimum and maximum values
based on a base value.</p>
<p>Args:</p>
<ul class="simple">
<li><p>filter_range (str): A string representing the range filter, e.g.,
“+/- 100”.</p></li>
<li><p>base_value (int): The base value to calculate the range from.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>tuple: A tuple containing the minimum and maximum values of the range.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="database.user_creation.update_user_data">
<span class="sig-prename descclassname"><span class="pre">database.user_creation.</span></span><span class="sig-name descname"><span class="pre">update_user_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">conn</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#database.user_creation.update_user_data" title="Link to this definition">¶</a></dt>
<dd><p>Updates an existing user’s data in the database.</p>
<p>Args:</p>
<ul class="simple">
<li><p>conn: Database connection object.</p></li>
</ul>
<p>Returns:</p>
<ul class="simple">
<li><p>int: The ID of the user whose data was updated.</p></li>
</ul>
<p>This function extracts updated user information from a submitted web form
and updates the user record in the database. It handles updates to personal
details, preferences, and filters, and returns the user’s ID.
This function also handles the standard formatting of profile pictures
(300x300px), fetching of a new isochrone and it updates the recommendations
database by calculating recommendations for the user based on their updated
information.</p>
</dd></dl>

</section>
<section id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Link to this heading">¶</a></h2>
<ul class="simple">
<li><p><a class="reference internal" href="utils.html#utils-label"><span class="std std-ref">Utils Module</span></a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a complete overview of all modules, visit <a class="reference internal" href="modules_overview.html#modules-overview-label"><span class="std std-ref">the modules overview page</span></a>.</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Redwood Prototype</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules_overview.html">Modules Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="frontend_backend_interaction.html">Frontend-Backend Interaction Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="database_schema.html">Database Schema Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="javascript.html">JavaScript</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="python_modules.html">Python Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="algorithms.html">Algorithms package</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Database package</a></li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils package</a></li>
<li class="toctree-l2"><a class="reference internal" href="web.html">Web package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="design_rationale.html">Design Rationale</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_setup.html">Environment Setup and Required Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="future_work.html">Future Work and Development Roadmap</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="python_modules.html">Python Modules</a><ul>
      <li>Previous: <a href="algorithms.html" title="previous chapter">Algorithms package</a></li>
      <li>Next: <a href="utils.html" title="next chapter">Utils package</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Ronan Geraghty.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 0.7.16</a>
      
      |
      <a href="_sources/database.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>